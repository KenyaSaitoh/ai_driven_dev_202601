# システム要件定義書

## 1. 概要

本ドキュメントは、人材管理システム（JSF Person）のシステム要件を定義する。

## 2. システムの目的

人材情報（PERSON）の登録、参照、更新、削除を行うWebアプリケーションシステム。従業員や関係者の基本情報を一元管理し、効率的な人材管理業務を支援することを目的とする。

## 3. 機能要件

### 3.1 主要機能

* PERSON一覧表示機能
  * データベースに登録されている全PERSON情報を一覧表示する
  * ID、名前、年齢、性別の情報を表形式で表示する
  * 各PERSONに対して編集・削除操作を提供する
  * 新規追加機能へのリンクを提供する

* PERSON追加機能
  * 新しいPERSON情報を入力する画面を提供する
  * 名前、年齢、性別の入力項目を持つ
  * 入力内容を確認画面で確認した後、データベースに登録する
  * 3画面フロー: 入力画面 → 確認画面 → 登録処理 → 一覧画面へ遷移

* PERSON編集機能
  * 既存のPERSON情報を編集する画面を提供する
  * 一覧画面から編集対象のPERSONを選択する
  * 既存データが入力画面にプリセットされる
  * 編集内容を確認画面で確認した後、データベースを更新する
  * 3画面フロー: 一覧画面 → 入力画面 → 確認画面 → 更新処理 → 一覧画面へ遷移

* PERSON削除機能
  * 指定されたPERSON情報を削除する
  * 一覧画面の削除ボタンから実行する
  * JavaScriptで削除確認ダイアログを表示する
  * 削除後、一覧画面に遷移する

### 3.2 画面一覧

* PERSON一覧画面（SCREEN_001_PersonList）
  * URL: /personList.do → /personList.xhtml
  * 目的: 全PERSON情報を一覧表示し、追加・編集・削除のエントリーポイントを提供する

* PERSON入力画面（SCREEN_002_PersonInput）
  * URL: /personInput.do → /personInput.xhtml
  * 目的: PERSON情報の入力または編集を行う
  * モード: 新規追加モードと編集モード

* PERSON確認画面（SCREEN_003_PersonConfirm）
  * URL: /personConfirm.do → /personConfirm.xhtml
  * 目的: 入力または編集されたPERSON情報を確認し、登録・更新を実行する

### 3.3 データ管理要件

* PERSONエンティティ
  * PERSON_ID: 自動採番される一意識別子（主キー）
  * PERSON_NAME: 名前（最大30文字、必須）
  * AGE: 年齢（整数、必須）
  * GENDER: 性別（male/female、必須）

* データ整合性
  * PERSON_IDは自動採番される
  * すべてのフィールドは必須項目
  * データベースレベルでNOT NULL制約を持つ

### 3.4 ビジネスルール

* PERSON追加時
  * PERSON_IDは自動採番される（ユーザーは入力しない）
  * すべてのフィールドが入力されていることを確認する
  * 確認画面で内容を確認した後、データベースに登録する

* PERSON編集時
  * 既存のPERSON_IDを維持する
  * すべてのフィールドが入力されていることを確認する
  * 確認画面で内容を確認した後、データベースを更新する

* PERSON削除時
  * JavaScriptで削除確認ダイアログを表示する
  * 確認後、指定されたPERSON_IDのレコードを削除する
  * 削除は即座に実行される（確認画面なし）

* 画面遷移ルール
  * 入力画面でキャンセルボタンをクリックすると一覧画面に戻る
  * 確認画面で戻るボタンをクリックすると入力画面に戻る（ブラウザ履歴を使用）
  * 登録・更新・削除後は一覧画面に遷移する

## 4. 非機能要件

### 4.1 技術スタック

* アプリケーション基盤
  * Java 21
  * Jakarta EE 10
  * Jakarta Faces (JSF) 4.0
  * Jakarta Persistence (JPA) 3.1
  * Jakarta CDI 4.0
  * Jakarta Transactions (JTA) 2.0

* アプリケーションサーバー
  * Payara Server 6.x

* データベース
  * HSQLDB 2.7.x（既存データベースを継続使用）

* ビルドツール
  * Gradle 8.x

### 4.2 データベース要件

* データベース種別
  * HSQLDB 2.7.x（既存のデータベースを継続使用）

* 接続方式
  * JDBC（JPA経由）
  * データソース名: java:app/jdbc/testdb
  * 接続プール管理: Payara Server

* データベーススキーマ
  * 既存のPERSONテーブル構造を維持する
  * テーブル名、カラム名は変更しない
  * スキーマ移行は行わない

### 4.3 トランザクション要件

* トランザクション管理
  * JTA（Jakarta Transactions）による宣言的トランザクション管理
  * Serviceクラスのメソッドレベルで@Transactionalアノテーションを使用
  * デフォルトのトランザクション境界: Serviceクラスのパブリックメソッド

* トランザクション分離レベル
  * READ_COMMITTED（HSQLDB デフォルト）

* ロールバック条件
  * RuntimeExceptionが発生した場合、自動的にロールバック
  * チェック例外はロールバックしない（必要に応じて@Transactional設定で指定）

### 4.4 認証・認可要件

* 認証
  * 本システムは認証機能を持たない
  * 将来的にJakarta Security機能を追加する可能性がある

* 認可
  * 本システムは認可機能を持たない
  * すべてのユーザーが全機能にアクセス可能

### 4.5 パフォーマンス要件

* レスポンスタイム
  * 一覧表示: 1秒以内
  * 登録・更新・削除: 2秒以内

* 同時接続数
  * 想定同時接続数: 10ユーザー
  * 教育目的のシステムのため、大規模トラフィックは想定しない

### 4.6 可用性要件

* 稼働率
  * 教育目的のシステムのため、特定の稼働率目標は設定しない

### 4.7 保守性・拡張性要件

* アーキテクチャパターン
  * レイヤードアーキテクチャを採用する
  * Presentation Layer、Business Logic Layer、Data Access Layerの3層構造
  * 各レイヤーは明確な責任分離を行う

* 依存性注入
  * CDI（@Inject）による依存性注入を使用する
  * テスタビリティを考慮した設計

* コーディング規約
  * Jakarta EE 10の標準的なベストプラクティスに従う
  * クラス名、メソッド名は明確で理解しやすい命名を行う

### 4.8 国際化要件

* 文字コード
  * UTF-8を使用する

* 言語
  * 日本語のみをサポート
  * 将来的に多言語対応の可能性がある

### 4.9 エラーハンドリング要件

* 例外処理
  * ビジネスロジック層で発生した例外はRuntimeExceptionでラップする
  * データベース例外はRuntimeExceptionとして上位層に伝播する
  * プレゼンテーション層でユーザーフレンドリーなエラーメッセージを表示する

* ロギング
  * 重要な処理（登録・更新・削除）ではログを出力する
  * 例外発生時はスタックトレースをログに記録する

## 5. 制約事項

### 5.1 技術的制約

* データベーススキーマは変更しない
  * 既存のPERSONテーブル構造を維持する
  * マイグレーション範囲はアプリケーション層のみ

* 既存データの互換性
  * 既存のPERSONデータを引き続き使用する
  * データ移行は不要

### 5.2 スコープ外

* 認証・認可機能
  * 本リリースではスコープ外
  * 将来的に追加の可能性がある

* 検索・フィルタリング機能
  * 本リリースではスコープ外
  * 全データを一覧表示のみ

* CSV出力・インポート機能
  * 本リリースではスコープ外

* ページネーション
  * 本リリースではスコープ外
  * 全データを1ページに表示

## 6. 参考資料

* [アーキテクチャ設計書](architecture_design.md) - システムアーキテクチャの詳細
* [データモデル](data_model.md) - データベーススキーマの詳細
* [機能設計書](functional_design.md) - 画面遷移とコンポーネント設計
* [振る舞い仕様書](behaviors.md) - システム全体の振る舞い
